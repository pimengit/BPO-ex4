<Window x:Class="BPO_ex4.StationViewWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vis="clr-namespace:BPO_ex4.Visuals"
        Title="Схема станции" Height="800" Width="1200"
        Background="#1E1E1E">

    <Grid>
        <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" PanningMode="Both">

            <ItemsControl Name="MainCanvasControl">

                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <Canvas Width="5000" Height="3000" Background="#101010"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>

                <ItemsControl.ItemContainerStyle>
                    <Style TargetType="ContentPresenter">
                        <Setter Property="Canvas.Left" Value="{Binding X}"/>
                        <Setter Property="Canvas.Top" Value="{Binding Y}"/>
                        <Setter Property="Panel.ZIndex" Value="{Binding ZIndex}"/>
                    </Style>
                </ItemsControl.ItemContainerStyle>

                <ItemsControl.Resources>

                    <DataTemplate DataType="{x:Type vis:SectionViewModel}">
                        <Grid>
                            <Rectangle Width="{Binding Width}" 
                                       Height="{Binding Height}" 
                                       Fill="{Binding FillColor}"
                                       Stroke="Black" StrokeThickness="1"
                                       RadiusX="1" RadiusY="1"
                                       ToolTip="{Binding Name}"
                                       Cursor="Hand">

                                <Rectangle.InputBindings>
                                    <MouseBinding Gesture="LeftClick" Command="{Binding ClickCommand}"/>
                                </Rectangle.InputBindings>

                            </Rectangle>

                            <TextBlock Text="{Binding Name}" 
                                       Foreground="Gray" 
                                       FontSize="10" 
                                       HorizontalAlignment="Center" 
                                       Margin="0,-15,0,0"
                                       IsHitTestVisible="False"/>
                        </Grid>
                    </DataTemplate>
                    <DataTemplate DataType="{x:Type vis:LightViewModel}">
                        <Grid>
                            <TextBlock Text="{Binding Name}" 
                       Foreground="White" FontSize="10" 
                       HorizontalAlignment="Center" 
                       Margin="0,-15,0,0"/>

                            <Rectangle Width="4" Height="14" Fill="Gray" Margin="0,12,0,0"/>

                            <Rectangle Width="10" Height="2" Fill="Gray" VerticalAlignment="Bottom" Margin="0,12,0,-2"/>

                            <Ellipse Width="14" Height="14" 
                     Fill="{Binding FillColor}"
                     Stroke="White" StrokeThickness="1"
                     ToolTip="{Binding Name}"
                     Cursor="Hand">
                            </Ellipse>
                        </Grid>
                    </DataTemplate>
                    <DataTemplate DataType="{x:Type vis:GarsViewModel}">
                        <Border Width="{Binding Width}" Height="{Binding Height}" Background="White" BorderBrush="Black" BorderThickness="1" ToolTip="{Binding Name}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="{Binding TextLeft}" Foreground="Black" FontSize="10" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center" TextAlignment="Center"/>
                                <Rectangle Grid.Column="1" Width="1" Fill="Black" Margin="0,2"/>
                                <TextBlock Grid.Column="2" Text="{Binding TextRight}" Foreground="Black" FontSize="10" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center" TextAlignment="Center"/>
                            </Grid>
                        </Border>
                    </DataTemplate>
                    <DataTemplate DataType="{x:Type vis:ZrViewModel}">
                        <Grid>
                            <Rectangle Width="{Binding Width}" 
                                       Height="{Binding Height}" 
                                       Fill="{Binding FillColor}"
                                       Stroke="Black" StrokeThickness="1"
                                       RadiusX="1" RadiusY="1"
                                       ToolTip="{Binding Name}"
                                       Cursor="Hand">

                                <Rectangle.InputBindings>
                                    <MouseBinding Gesture="LeftClick" Command="{Binding ZrCommand}"/>
                                </Rectangle.InputBindings>

                            </Rectangle>

                            <TextBlock Text="{Binding Name}" 
                                       Foreground="Gray" 
                                       FontSize="10" 
                                       HorizontalAlignment="Center" 
                                       Margin="0,-15,0,0"
                                       IsHitTestVisible="False"/>
                        </Grid>
                    </DataTemplate>
                    <DataTemplate DataType="{x:Type vis:SwitchViewModel}">
                        <Grid>
                            <Ellipse Width="20" Height="20" 
                 Fill="{Binding FillColor}"
                 Stroke="White" StrokeThickness="2"
                 ToolTip="{Binding Name}"
                 Cursor="Hand">

                                <Ellipse.InputBindings>
                                    <MouseBinding Gesture="LeftClick" Command="{Binding LeftClickCommand}"/>
                                    <MouseBinding Gesture="RightClick" Command="{Binding RightClickCommand}"/>
                                </Ellipse.InputBindings>
                            </Ellipse>

                            <TextBlock Text="{Binding Name}" 
                   Foreground="Black" FontWeight="Bold" FontSize="10" 
                   HorizontalAlignment="Center" VerticalAlignment="Center"
                   IsHitTestVisible="False"/>
                        </Grid>
                    </DataTemplate>

                </ItemsControl.Resources>
            </ItemsControl>
        </ScrollViewer>

        <Border VerticalAlignment="Top" HorizontalAlignment="Left" 
                Background="#CC000000" Padding="10" Margin="10" CornerRadius="5">
            <TextBlock Text="ЛКМ по объекту - просмотр состояния" Foreground="White"/>
        </Border>
    </Grid>
</Window>